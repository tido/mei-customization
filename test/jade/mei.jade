- var keys = { 'treble': { clefLine: 2, clefShape: 'G' }, 'bass': { clefLine: 4, clefShape: 'F' } }

mixin scoreDef(attrs)
  -
    attrs = _.assign({}, {
      meterCount: 4,
      meterUnit: 4,
      keyPname: 'c',
      keyAccid: 'n',
      keyMode: 'major',
      clefs: ['treble', 'bass'],
      staffCount: 1,
    }, attrs);

  scoreDef(xml:id=_.uniqueId('j'))
    staffGrp(xml:id=_.uniqueId('j'))
      - each index in _.range(attrs.staffCount)
        - var key = keys[attrs.clefs[index]] || keys.treble
        - var staffN = index + 1
        staffDef(n=staffN, lines=5, xml:id=_.uniqueId('j'))
          clef(line=key.clefLine, shape=key.clefShape, xml:id=_.uniqueId('j'))
          keySig(pname=attrs.keyPname, accid=attrs.keyAccid, mode=attrs.keyMode, xml:id=_.uniqueId('j'))
          meterSig(count=attrs.meterCount, unit=attrs.meterUnit, xml:id=_.uniqueId('j'))


doctype xml
<?xml-model href="../../../schema/odd/schemata/tido.rng" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<?xml-model href="../../../schema/odd/schemata/tido.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>
// THIS FILE IS AUTOMATICALLY GENERATED. DO NOT EDIT THIS FILE DIRECTLY.
mei(xmlns:xlink="http://www.w3.org/1999/xlink", xmlns="http://www.music-encoding.org/ns/mei", xmlns:tido="http://tido-music.com/ns/1.0", meiversion="3.0.0", xml:id="s1")
  meiHead(xml:id="s2")
    fileDesc(xml:id="s3")
      titleStmt(xml:id="s4")
        title(xml:id="s5") Test file generated by Jade
        respStmt(xml:id="s6"): corpName(role="creator", xml:id="s7") Tido Enterprise GmbH
      pubStmt(xml:id="s8")
        respStmt(xml:id="s9"): corpName(xml:id="s10") Tido Enterprise GmbH
        address(xml:id="s11")
          addrLine(xml:id="s12") Talstrasse, Leipzig
        availability(xml:id="s13")
          useRestrict(xml:id="s14") All right reserved.
      seriesStmt(xml:id="s15")
        title(xml:id="s16") Tido MEI Examplars
        respStmt(xml:id="s17"): corpName(xml:id="s16a") Tido
    encodingDesc(xml:id="s18")
      projectDesc(xml:id="s19")
        p(xml:id="s20") Encoded by hand in order to illustrate the encoding of a specific notation
  music(xml:id="s21")
    body(xml:id="s22")
      mdiv(xml:id="s23")
        score(xml:id="s24")
          block score
            block scoreDef
              //- define block scoreDef to change the score definition (utility mixin provided for this)
              +scoreDef()
            section(xml:id="s25")
              block section
